#!/bin/bash

DEFAULT_VERSION=v0.1.0-alpha

if [ -d .git ] ; then
	VERSION=$(git describe --always --dirty 2>/dev/null)
fi

if [ -z "$VERSION" ] ; then
	VERSION=$DEFAULT_VERSION
fi

if [ ! -f src/version.hh ] || ! grep -q \"$VERSION\" src/version.hh ; then
	echo "#define SPOONY_VERSION \"$VERSION\"" > src/version.hh
fi

tup
